# ExploitationService.py

import sqlite3

DB_NAME = 'agriculture_db.sqlite'

class ExploitationService:
    @staticmethod
    def get_connection():
        conn = sqlite3.connect(DB_NAME)
        conn.row_factory = sqlite3.Row
        return conn

    @staticmethod
    def get_all_exploitations():
        conn = ExploitationService.get_connection()
        exploitations = conn.execute('SELECT * FROM exploitations').fetchall()
        conn.close()
        return exploitations

    @staticmethod
    def add_exploitation(nom, superficie):
        conn = ExploitationService.get_connection()
        conn.execute('INSERT INTO exploitations (nom_exploitation, superficie) VALUES (?, ?)', (nom, superficie))
        conn.commit()
        conn.close()

    @staticmethod
    def update_exploitation(id, nom, superficie):
        conn = ExploitationService.get_connection()
        conn.execute('UPDATE exploitations SET nom_exploitation = ?, superficie = ? WHERE id_exploitation = ?', 
                     (nom, superficie, id))
        conn.commit()
        conn.close()

    @staticmethod
    def delete_exploitation(id):
        conn = ExploitationService.get_connection()
        conn.execute('DELETE FROM exploitations WHERE id_exploitation = ?', (id,))
        conn.commit()
        conn.close()
